document.querySelectorAll('.cheat-title span').forEach(span => {
    span.addEventListener('click', () => {
        span.style.transform = 'scale(1.4) rotate(-16deg)';
        setTimeout(() => {
            span.style.transform = '';
        }, 350);
    });
});

const btn = document.querySelector('.modern-btn');
if (btn) {
    btn.addEventListener('click', () => {
        btn.style.transform = 'scale(1.2)';
        setTimeout(() => {
            btn.style.transform = '';
        }, 200);
    });
}

const canvas = document.getElementById('stars-bg');
const ctx = canvas.getContext('2d');
let w, h;
function resize() {
    w = window.innerWidth;
    h = window.innerHeight;
    canvas.width = w;
    canvas.height = h;
}
window.addEventListener('resize', resize);
resize();

const colors = ['#e879f9', '#a855f7', '#ec4899', '#fff'];
const stars = Array.from({length: 80}, () => ({
    x: Math.random() * w,
    y: Math.random() * h,
    r: Math.random() * 2 + 1,
    color: colors[Math.floor(Math.random() * colors.length)],
    dx: (Math.random() - 0.5) * 0.15,
    dy: (Math.random() - 0.5) * 0.15
}));

function animateStars() {
    ctx.clearRect(0, 0, w, h);
    for (const star of stars) {
        ctx.beginPath();
        ctx.arc(star.x, star.y, star.r, 0, Math.PI * 2);
        ctx.fillStyle = star.color;
        ctx.globalAlpha = 0.8;
        ctx.fill();
        ctx.globalAlpha = 1;
        star.x += star.dx;
        star.y += star.dy;
        if (star.x < 0) star.x = w;
        if (star.x > w) star.x = 0;
        if (star.y < 0) star.y = h;
        if (star.y > h) star.y = 0;
    }
    requestAnimationFrame(animateStars);
}
animateStars();

// Modal logic
function openModal(id) {
    document.getElementById(id).classList.add('show');
}
function closeModal(id) {
    document.getElementById(id).classList.remove('show');
}
document.getElementById('btn-termes').onclick = () => openModal('modal-termes');
document.getElementById('btn-avis').onclick = () => openModal('modal-avis');
document.querySelectorAll('.close').forEach(btn => {
    btn.onclick = () => closeModal(btn.dataset.close);
});
window.addEventListener('keydown', e => {
    if (e.key === 'Escape') {
        document.querySelectorAll('.modal.show').forEach(modal => modal.classList.remove('show'));
    }
});

// Avis logic via Discord Webhook
const avisForm = document.getElementById('avis-form');
const avisList = document.getElementById('avis-list');

// Remplace par ton URL de webhook Discord
const WEBHOOK_URL = "https://discord.com/api/webhooks/1406420197707087973/dzE0YA2IVj0w6rdRTLh4bf0NY1Lu6vTp3o-Hg2wTNSaqxHvykj0bco33smiUnVk7_M2o";
const AVIS_COOLDOWN_MS = 60 * 60 * 1000; // 1 heure

function canSendAvis() {
    const last = localStorage.getItem('avis-last');
    if (!last) return true;
    return (Date.now() - parseInt(last, 10)) > AVIS_COOLDOWN_MS;
}

function setAvisSentNow() {
    localStorage.setItem('avis-last', Date.now().toString());
}

avisForm.onsubmit = async function(e) {
    e.preventDefault();
    const nom = document.getElementById('avis-nom').value.trim();
    const text = document.getElementById('avis-text').value.trim();
    const note = parseInt(document.getElementById('avis-note').value, 10);

    if (!canSendAvis()) {
        avisList.innerHTML = `<div style="color:#ff1f1f;margin-top:1em;">‚è≥ Tu as d√©j√† envoy√© un avis r√©cemment.<br>Merci de patienter 1h avant d'en envoyer un autre.</div>`;
        return;
    }

    if (nom && text && note) {
        // Embed Discord pour un message joli
        const embed = {
            title: "Nouvel avis utilisateur",
            color: 0xa855f7,
            fields: [
                { name: "üë§ Pseudo", value: nom, inline: true },
                { name: "‚≠ê Note", value: "‚òÖ".repeat(note), inline: true },
                { name: "üí¨ Avis", value: text }
            ],
            timestamp: new Date().toISOString()
        };
        try {
            await fetch(WEBHOOK_URL, {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({
                    embeds: [embed]
                })
            });
            setAvisSentNow();
            avisForm.reset();
            avisList.innerHTML = `<div style="color:#a855f7;margin-top:1em;">‚úÖ Merci pour ton avis ! Il a bien √©t√© envoy√©.<br><span style="font-size:0.95em;opacity:0.7;">(Tu pourras en envoyer un autre dans 1h)</span></div>`;
        } catch (err) {
            avisList.innerHTML = `<div style="color:#ff1f1f;margin-top:1em;">‚ùå Erreur lors de l'envoi de l'avis.</div>`;
        }
    }
}

// Animation curseur souris
const mouseCursor = document.getElementById('mouse-cursor');
window.addEventListener('mousemove', e => {
    mouseCursor.style.left = e.clientX + 'px';
    mouseCursor.style.top = e.clientY + 'px';
});

// Barre de recherche cheat
const searchInput = document.getElementById('cheat-search');
const cheatBoxes = document.querySelectorAll('#cheat-list .download-box');
searchInput.addEventListener('input', function() {
    const val = this.value.toLowerCase();
    cheatBoxes.forEach(box => {
        const title = box.querySelector('.box-title').textContent.toLowerCase();
        if (title.includes(val)) {
            box.classList.remove('hide');
        } else {
            box.classList.add('hide');
        }
    });
});

const langData = {
    fr: {
        searchPlaceholder: "Rechercher des cheats...",
        btnTermes: "Termes",
        btnAvis: "Avis",
        watermark: "dev by jules",
        download: "T√©l√©charger",
        update: "Update",
        down: "DOWN",
        price: "Prix : <b>Gratuit</b>",
        modalTermes: "üìú R√®glement du Serveur Discord üìú",
        modalAvis: "Les avis des utilisateurs",
        modalTermesContent: `
Bienvenue sur notre serveur ! Avant de participer, merci de lire et de respecter les r√®gles ci-dessous afin de garantir une bonne ambiance pour tous.<br><br>
<b>Respect :</b> Le respect mutuel est essentiel. Aucune insulte, discrimination, harc√®lement ou comportement toxique ne sera tol√©r√©.<br><br>
<b>Pas de Spam :</b> √âvitez de spammer les salons, les messages priv√©s ou les mentions. Le spam inutile perturbe la communaut√©.<br><br>
<b>Contenu Inappropri√© :</b> Tout contenu inappropri√© (NSFW, violence, etc.) est strictement interdit. Restez dans le cadre des r√®gles de Discord.<br><br>
<b>Publicit√© :</b> Aucune publicit√© pour d'autres serveurs, produits ou services n'est autoris√©e sans l'accord pr√©alable de l'administration.<br><br>
<b>Utilisation des salons :</b> Chaque salon a un but pr√©cis. Merci de respecter les th√©matiques des canaux et d'utiliser le bon salon pour chaque discussion.<br><br>
<b>Aide et Tickets :</b> Si tu as un probl√®me ou une question, utilise le syst√®me de tickets (PAS DE MP AUX ADMINS OU AU FONDATEUR). Nous sommes l√† pour t'aider !<br><br>
<b>Cheats et Hacks :</b> L'utilisation ou le partage d'outils non autoris√©s en dehors du cadre du serveur est strictement interdit. Toute violation est sous ta responsabilit√©.<br><br>
<b>Respect des Mod√©rateurs :</b> Les d√©cisions des mod√©rateurs doivent √™tre respect√©es. En cas de d√©saccord, discutez-en calmement.<br><br>
<b>Sanctions :</b> Le non-respect des r√®gles peut entra√Æner un avertissement, un kick, ou un ban, selon la gravit√© de l'infraction.
        `,
        download: "T√©l√©charger",
        update: "Mettre √† jour",
        down: "HORS LIGNE",
        price: "Prix : <b>Gratuit</b>",
        modalTermes: "üìú R√®glement du Serveur Discord üìú",
        modalAvis: "Les avis des utilisateurs",
        avisPseudo: "Votre pseudo",
        avisText: "Votre avis...",
        avisEnvoyer: "Envoyer",
        discordLogin: "Connexion Discord",
        discordLogout: "D√©connexion",
        discordLink: "Discord Link",
        avisNote: ["‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê", "‚≠ê‚≠ê‚≠ê‚≠ê", "‚≠ê‚≠ê‚≠ê", "‚≠ê‚≠ê", "‚≠ê"],
        popupConnect: "Tu dois √™tre connect√© avec Discord pour t√©l√©charger.",
        popupBtn: "Se connecter",
    },
    en: {
        searchPlaceholder: "Search cheats...",
        btnTermes: "Terms",
        btnAvis: "Reviews",
        watermark: "dev by jules",
        download: "Download",
        update: "Update",
        down: "DOWN",
        price: "Price: <b>Free</b>",
        modalTermes: "üìú Discord Server Rules üìú",
        modalAvis: "User Reviews",
        modalTermesContent: `
Welcome to our server! Before participating, please read and follow the rules below to ensure a good atmosphere for everyone.<br><br>
<b>Respect:</b> Mutual respect is essential. No insults, discrimination, harassment, or toxic behavior will be tolerated.<br><br>
<b>No Spam:</b> Avoid spamming channels, private messages, or mentions. Unnecessary spam disrupts the community.<br><br>
<b>Inappropriate Content:</b> Any inappropriate content (NSFW, violence, etc.) is strictly prohibited. Stay within Discord's rules.<br><br>
<b>Advertising:</b> No advertising for other servers, products, or services is allowed without prior admin approval.<br><br>
<b>Channel Usage:</b> Each channel has a specific purpose. Please respect the topics and use the correct channel for each discussion.<br><br>
<b>Help & Tickets:</b> If you have a problem or question, use the ticket system (NO DMs TO ADMINS OR THE FOUNDER). We're here to help!<br><br>
<b>Cheats & Hacks:</b> Using or sharing unauthorized tools outside the server is strictly prohibited. Any violation is your responsibility.<br><br>
<b>Respect Moderators:</b> Moderator decisions must be respected. If you disagree, discuss calmly.<br><br>
<b>Sanctions:</b> Breaking the rules may result in a warning, kick, or ban, depending on the severity.
        `,
        download: "Download",
        update: "Update",
        down: "DOWN",
        price: "Price: <b>Free</b>",
        modalTermes: "üìú Discord Server Rules üìú",
        modalAvis: "User Reviews",
        avisPseudo: "Your nickname",
        avisText: "Your review...",
        avisEnvoyer: "Send",
        discordLogin: "Discord Login",
        discordLogout: "Logout",
        discordLink: "Discord Link",
        avisNote: ["‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê", "‚≠ê‚≠ê‚≠ê‚≠ê", "‚≠ê‚≠ê‚≠ê", "‚≠ê‚≠ê", "‚≠ê"],
        popupConnect: "You must be connected with Discord to download.",
        popupBtn: "Login",
    },
    zh: {
        searchPlaceholder: "ÊêúÁ¥¢‰ΩúÂºä...",
        btnTermes: "Êù°Ê¨æ",
        btnAvis: "ËØÑËÆ∫",
        watermark: "Áî± jules ÂºÄÂèë",
        download: "‰∏ãËΩΩ",
        update: "Êõ¥Êñ∞",
        down: "ÂÖ≥Èó≠",
        price: "‰ª∑Ê†º: <b>ÂÖçË¥π</b>",
        modalTermes: "üìú DiscordÊúçÂä°Âô®ËßÑÂàô üìú",
        modalAvis: "Áî®Êà∑ËØÑËÆ∫",
        modalTermesContent: `
Ê¨¢ËøéÂä†ÂÖ•Êàë‰ª¨ÁöÑÊúçÂä°Âô®ÔºÅÂú®ÂèÇ‰∏é‰πãÂâçÔºåËØ∑ÈòÖËØªÂπ∂ÈÅµÂÆà‰ª•‰∏ãËßÑÂàôÔºå‰ª•Á°Æ‰øùÂ§ßÂÆ∂ÊúâËâØÂ•ΩÁöÑÊ∞õÂõ¥„ÄÇ<br><br>
<b>Â∞äÈáçÔºö</b> Áõ∏‰∫íÂ∞äÈáçËá≥ÂÖ≥ÈáçË¶Å„ÄÇÁ¶ÅÊ≠¢‰ªª‰Ωï‰æÆËæ±„ÄÅÊ≠ßËßÜ„ÄÅÈ™öÊâ∞ÊàñÊúâÂÆ≥Ë°å‰∏∫„ÄÇ<br><br>
<b>Á¶ÅÊ≠¢Âà∑Â±èÔºö</b> ËØ∑ÂãøÂú®È¢ëÈÅì„ÄÅÁßÅ‰ø°Êàñ@‰∏≠Âà∑Â±è„ÄÇÊó†ÊÑè‰πâÁöÑÂà∑Â±è‰ºöÊâ∞‰π±Á§æÂå∫„ÄÇ<br><br>
<b>‰∏çÂΩìÂÜÖÂÆπÔºö</b> ‰∏•Á¶ÅÂèëÂ∏É‰ªª‰Ωï‰∏çÂΩìÂÜÖÂÆπÔºàNSFW„ÄÅÊö¥ÂäõÁ≠âÔºâ„ÄÇËØ∑ÈÅµÂÆàDiscordËßÑÂàô„ÄÇ<br><br>
<b>ÂπøÂëäÔºö</b> Êú™ÁªèÁÆ°ÁêÜÂëòËÆ∏ÂèØÔºåÁ¶ÅÊ≠¢ÂÆ£‰º†ÂÖ∂‰ªñÊúçÂä°Âô®„ÄÅ‰∫ßÂìÅÊàñÊúçÂä°„ÄÇ<br><br>
<b>È¢ëÈÅì‰ΩøÁî®Ôºö</b> ÊØè‰∏™È¢ëÈÅìÊúâÁâπÂÆöÁî®ÈÄî„ÄÇËØ∑Â∞äÈáç‰∏ªÈ¢òÂπ∂Âú®Ê≠£Á°ÆÈ¢ëÈÅìËÆ®ËÆ∫„ÄÇ<br><br>
<b>Â∏ÆÂä©‰∏éÂ∑•ÂçïÔºö</b> Â¶ÇÊúâÈóÆÈ¢òËØ∑‰ΩøÁî®Â∑•ÂçïÁ≥ªÁªüÔºà‰∏çË¶ÅÁßÅ‰ø°ÁÆ°ÁêÜÂëòÊàñÂàõÂßã‰∫∫Ôºâ„ÄÇÊàë‰ª¨‰ºöÂ∏ÆÂä©‰Ω†ÔºÅ<br><br>
<b>‰ΩúÂºä‰∏éÁ†¥Ëß£Ôºö</b> ‰∏•Á¶ÅÂú®ÊúçÂä°Âô®Â§ñ‰ΩøÁî®ÊàñÂàÜ‰∫´Êú™ÊéàÊùÉÂ∑•ÂÖ∑„ÄÇËøùËßÑÂêéÊûúËá™Ë¥ü„ÄÇ<br><br>
<b>Â∞äÈáçÁÆ°ÁêÜÂëòÔºö</b> ÂøÖÈ°ªÂ∞äÈáçÁÆ°ÁêÜÂëòÂÜ≥ÂÆö„ÄÇÂ¶ÇÊúâÂºÇËÆÆËØ∑ÂÜ∑ÈùôËÆ®ËÆ∫„ÄÇ<br><br>
<b>Â§ÑÁΩöÔºö</b> ËøùÂèçËßÑÂàôÂèØËÉΩË¢´Ë≠¶Âëä„ÄÅË∏¢Âá∫ÊàñÂ∞ÅÁ¶ÅÔºåËßÜÊÉÖÂÜµËÄåÂÆö„ÄÇ
        `,
        download: "‰∏ãËΩΩ",
        update: "Êõ¥Êñ∞",
        down: "ÂÖ≥Èó≠",
        price: "‰ª∑Ê†º: <b>ÂÖçË¥π</b>",
        modalTermes: "üìú DiscordÊúçÂä°Âô®ËßÑÂàô üìú",
        modalAvis: "Áî®Êà∑ËØÑËÆ∫",
        avisPseudo: "‰Ω†ÁöÑÊòµÁß∞",
        avisText: "‰Ω†ÁöÑËØÑËÆ∫...",
        avisEnvoyer: "ÂèëÈÄÅ",
        discordLogin: "Discord ÁôªÂΩï",
        discordLogout: "ÈÄÄÂá∫",
        discordLink: "DiscordÈìæÊé•",
        avisNote: ["‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê", "‚≠ê‚≠ê‚≠ê‚≠ê", "‚≠ê‚≠ê‚≠ê", "‚≠ê‚≠ê", "‚≠ê"],
        popupConnect: "‰Ω†ÂøÖÈ°ªÁî® Discord ÁôªÂΩïÊâçËÉΩ‰∏ãËΩΩ„ÄÇ",
        popupBtn: "ÁôªÂΩï",
    },
    ru: {
        searchPlaceholder: "–ü–æ–∏—Å–∫ —á–∏—Ç–æ–≤...",
        btnTermes: "–ü—Ä–∞–≤–∏–ª–∞",
        btnAvis: "–û—Ç–∑—ã–≤—ã",
        watermark: "—Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–æ jules",
        download: "–°–∫–∞—á–∞—Ç—å",
        update: "–û–±–Ω–æ–≤–∏—Ç—å",
        down: "–ù–ï –†–ê–ë–û–¢–ê–ï–¢",
        price: "–¶–µ–Ω–∞: <b>–ë–µ—Å–ø–ª–∞—Ç–Ω–æ</b>",
        modalTermes: "üìú –ü—Ä–∞–≤–∏–ª–∞ Discord —Å–µ—Ä–≤–µ—Ä–∞ üìú",
        modalAvis: "–û—Ç–∑—ã–≤—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π",
        modalTermesContent: `
–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –Ω–∞ –Ω–∞—à —Å–µ—Ä–≤–µ—Ä! –ü–µ—Ä–µ–¥ —É—á–∞—Å—Ç–∏–µ–º –æ–∑–Ω–∞–∫–æ–º—å—Ç–µ—Å—å —Å –ø—Ä–∞–≤–∏–ª–∞–º–∏ –Ω–∏–∂–µ –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∞–Ω–∏—è —Ö–æ—Ä–æ—à–µ–π –∞—Ç–º–æ—Å—Ñ–µ—Ä—ã.<br><br>
<b>–£–≤–∞–∂–µ–Ω–∏–µ:</b> –í–∑–∞–∏–º–Ω–æ–µ —É–≤–∞–∂–µ–Ω–∏–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ. –û—Å–∫–æ—Ä–±–ª–µ–Ω–∏—è, –¥–∏—Å–∫—Ä–∏–º–∏–Ω–∞—Ü–∏—è, —Ç—Ä–∞–≤–ª—è –∏ —Ç–æ–∫—Å–∏—á–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ –∑–∞–ø—Ä–µ—â–µ–Ω—ã.<br><br>
<b>–ë–µ–∑ —Å–ø–∞–º–∞:</b> –ù–µ —Å–ø–∞–º—å—Ç–µ –≤ –∫–∞–Ω–∞–ª–∞—Ö, –ª–∏—á–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏—è—Ö –∏–ª–∏ —É–ø–æ–º–∏–Ω–∞–Ω–∏—è—Ö. –°–ø–∞–º –º–µ—à–∞–µ—Ç —Å–æ–æ–±—â–µ—Å—Ç–≤—É.<br><br>
<b>–ù–µ–ø—Ä–∏–µ–º–ª–µ–º—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç:</b> –õ—é–±–æ–π –Ω–µ–ø—Ä–∏–µ–º–ª–µ–º—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç (NSFW, –Ω–∞—Å–∏–ª–∏–µ –∏ —Ç.–¥.) —Å—Ç—Ä–æ–≥–æ –∑–∞–ø—Ä–µ—â–µ–Ω. –°–æ–±–ª—é–¥–∞–π—Ç–µ –ø—Ä–∞–≤–∏–ª–∞ Discord.<br><br>
<b>–†–µ–∫–ª–∞–º–∞:</b> –†–µ–∫–ª–∞–º–∞ –¥—Ä—É–≥–∏—Ö —Å–µ—Ä–≤–µ—Ä–æ–≤, –ø—Ä–æ–¥—É–∫—Ç–æ–≤ –∏–ª–∏ —É—Å–ª—É–≥ –±–µ–∑ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ü–∏–∏ –∑–∞–ø—Ä–µ—â–µ–Ω–∞.<br><br>
<b>–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–∞–Ω–∞–ª–æ–≤:</b> –ö–∞–∂–¥—ã–π –∫–∞–Ω–∞–ª –∏–º–µ–µ—Ç —Å–≤–æ—é —Ç–µ–º—É. –°–æ–±–ª—é–¥–∞–π—Ç–µ —Ç–µ–º–∞—Ç–∏–∫—É –∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –∫–∞–Ω–∞–ª.<br><br>
<b>–ü–æ–º–æ—â—å –∏ —Ç–∏–∫–µ—Ç—ã:</b> –ï—Å–ª–∏ –µ—Å—Ç—å –≤–æ–ø—Ä–æ—Å –∏–ª–∏ –ø—Ä–æ–±–ª–µ–º–∞, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–∏—Å—Ç–µ–º—É —Ç–∏–∫–µ—Ç–æ–≤ (–ù–ï –ü–ò–®–ò–¢–ï –í –õ–° –ê–î–ú–ò–ù–ê–ú –ò–õ–ò –û–°–ù–û–í–ê–¢–ï–õ–Æ). –ú—ã –ø–æ–º–æ–∂–µ–º!<br><br>
<b>–ß–∏—Ç—ã –∏ —Ö–∞–∫–∏:</b> –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∏–ª–∏ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ—Ä–∞–∑—Ä–µ—à—ë–Ω–Ω—ã—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –≤–Ω–µ —Å–µ—Ä–≤–µ—Ä–∞ –∑–∞–ø—Ä–µ—â–µ–Ω–æ. –ù–∞—Ä—É—à–µ–Ω–∏—è –Ω–∞ –≤–∞—à–µ–π –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏.<br><br>
<b>–£–≤–∞–∂–µ–Ω–∏–µ –∫ –º–æ–¥–µ—Ä–∞—Ç–æ—Ä–∞–º:</b> –†–µ—à–µ–Ω–∏—è –º–æ–¥–µ—Ä–∞—Ç–æ—Ä–æ–≤ –¥–æ–ª–∂–Ω—ã —É–≤–∞–∂–∞—Ç—å—Å—è. –í —Å–ª—É—á–∞–µ –Ω–µ—Å–æ–≥–ª–∞—Å–∏—è –æ–±—Å—É–∂–¥–∞–π—Ç–µ —Å–ø–æ–∫–æ–π–Ω–æ.<br><br>
<b>–°–∞–Ω–∫—Ü–∏–∏:</b> –ù–∞—Ä—É—à–µ–Ω–∏–µ –ø—Ä–∞–≤–∏–ª –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—é, –∫–∏–∫—É –∏–ª–∏ –±–∞–Ω—É –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç—è–∂–µ—Å—Ç–∏.
        `,
        download: "–°–∫–∞—á–∞—Ç—å",
        update: "–û–±–Ω–æ–≤–∏—Ç—å",
        down: "–ù–ï –†–ê–ë–û–¢–ê–ï–¢",
        price: "–¶–µ–Ω–∞: <b>–ë–µ—Å–ø–ª–∞—Ç–Ω–æ</b>",
        modalTermes: "üìú –ü—Ä–∞–≤–∏–ª–∞ Discord —Å–µ—Ä–≤–µ—Ä–∞ üìú",
        modalAvis: "–û—Ç–∑—ã–≤—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π",
        avisPseudo: "–í–∞—à –Ω–∏–∫",
        avisText: "–í–∞—à –æ—Ç–∑—ã–≤...",
        avisEnvoyer: "–û—Ç–ø—Ä–∞–≤–∏—Ç—å",
        discordLogin: "–í–æ–π—Ç–∏ —á–µ—Ä–µ–∑ Discord",
        discordLogout: "–í—ã–π—Ç–∏",
        discordLink: "–°—Å—ã–ª–∫–∞ Discord",
        avisNote: ["‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê", "‚≠ê‚≠ê‚≠ê‚≠ê", "‚≠ê‚≠ê‚≠ê", "‚≠ê‚≠ê", "‚≠ê"],
        popupConnect: "–ß—Ç–æ–±—ã —Å–∫–∞—á–∞—Ç—å, –Ω—É–∂–Ω–æ –≤–æ–π—Ç–∏ —á–µ—Ä–µ–∑ Discord.",
        popupBtn: "–í–æ–π—Ç–∏",
    },
    de: {
        searchPlaceholder: "Cheats suchen...",
        btnTermes: "Regeln",
        btnAvis: "Bewertungen",
        watermark: "entwickelt von jules",
        download: "Herunterladen",
        update: "Update",
        down: "DOWN",
        price: "Preis: <b>Kostenlos</b>",
        modalTermes: "üìú Discord-Server Regeln üìú",
        modalAvis: "Nutzerbewertungen",
        modalTermesContent: `
Willkommen auf unserem Server! Bitte lies und beachte die folgenden Regeln, um eine gute Atmosph√§re f√ºr alle zu gew√§hrleisten.<br><br>
<b>Respekt:</b> Gegenseitiger Respekt ist wichtig. Beleidigungen, Diskriminierung, Bel√§stigung oder toxisches Verhalten sind verboten.<br><br>
<b>Kein Spam:</b> Spam in Kan√§len, privaten Nachrichten oder Erw√§hnungen ist zu vermeiden. Unn√∂tiger Spam st√∂rt die Community.<br><br>
<b>Unangemessene Inhalte:</b> Jegliche unangemessenen Inhalte (NSFW, Gewalt usw.) sind streng verboten. Halte dich an die Discord-Regeln.<br><br>
<b>Werbung:</b> Werbung f√ºr andere Server, Produkte oder Dienstleistungen ist ohne vorherige Zustimmung der Admins nicht erlaubt.<br><br>
<b>Kanalnutzung:</b> Jeder Kanal hat einen bestimmten Zweck. Bitte respektiere die Themen und nutze den richtigen Kanal.<br><br>
<b>Hilfe & Tickets:</b> Bei Problemen oder Fragen nutze das Ticketsystem (KEINE DMs AN ADMINS ODER DEN GR√úNDER). Wir helfen dir!<br><br>
<b>Cheats & Hacks:</b> Die Nutzung oder Weitergabe nicht genehmigter Tools au√üerhalb des Servers ist streng verboten. Verst√∂√üe liegen in deiner Verantwortung.<br><br>
<b>Respekt gegen√ºber Moderatoren:</b> Entscheidungen der Moderatoren sind zu respektieren. Bei Meinungsverschiedenheiten diskutiere ruhig.<br><br>
<b>Sanktionen:</b> Regelverst√∂√üe k√∂nnen je nach Schwere zu einer Verwarnung, einem Kick oder einem Bann f√ºhren.
        `,
        download: "Herunterladen",
        update: "Update",
        down: "DOWN",
        price: "Preis: <b>Kostenlos</b>",
        modalTermes: "üìú Discord-Server Regeln üìú",
        modalAvis: "Nutzerbewertungen",
        avisPseudo: "Dein Name",
        avisText: "Deine Bewertung...",
        avisEnvoyer: "Senden",
        discordLogin: "Discord Anmeldung",
        discordLogout: "Abmelden",
        discordLink: "Discord Link",
        avisNote: ["‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê", "‚≠ê‚≠ê‚≠ê‚≠ê", "‚≠ê‚≠ê‚≠ê", "‚≠ê‚≠ê", "‚≠ê"],
        popupConnect: "Du musst mit Discord verbunden sein, um herunterzuladen.",
        popupBtn: "Anmelden",
    }
};

function setLang(lang) {
    document.getElementById('cheat-search').placeholder = langData[lang].searchPlaceholder;
    document.getElementById('btn-termes').textContent = langData[lang].btnTermes;
    document.getElementById('btn-avis').textContent = langData[lang].btnAvis;
    const watermark = document.querySelector('.watermark');
    if (watermark) watermark.textContent = langData[lang].watermark;

    // Traduction dynamique des box
    document.querySelectorAll('#cheat-list .download-box').forEach(box => {
        const btn = box.querySelector('.download-btn');
        if (btn) btn.textContent = langData[lang].download;
        const price = box.querySelector('.box-price');
        if (price) price.innerHTML = langData[lang].price;
        const stock = box.querySelector('.box-stock');
        if (stock) {
            if (box.classList.contains('down')) {
                stock.textContent = langData[lang].down;
            } else {
                stock.textContent = langData[lang].update;
            }
        }
    });

    // Traduction modals
    const modalTermesTitle = document.querySelector('#modal-termes .modal-content h2');
    if (modalTermesTitle) modalTermesTitle.textContent = langData[lang].modalTermes;
    const modalTermesContent = document.querySelector('#modal-termes .modal-content p');
    if (modalTermesContent) modalTermesContent.innerHTML = langData[lang].modalTermesContent;
    const modalAvisTitle = document.querySelector('#modal-avis .modal-content h2');
    if (modalAvisTitle) modalAvisTitle.textContent = langData[lang].modalAvis;

    // Traduction formulaire avis
    const avisPseudo = document.getElementById('avis-nom');
    if (avisPseudo) avisPseudo.placeholder = langData[lang].avisPseudo;
    const avisText = document.getElementById('avis-text');
    if (avisText) avisText.placeholder = langData[lang].avisText;
    const avisEnvoyer = document.querySelector('#avis-form button[type="submit"]');
    if (avisEnvoyer) avisEnvoyer.textContent = langData[lang].avisEnvoyer;

    // Traduction Discord login/logout
    const discordLoginBtn = document.getElementById('discord-login');
    if (discordLoginBtn) discordLoginBtn.textContent = langData[lang].discordLogin;
    const discordLogoutBtn = document.getElementById('discord-logout');
    if (discordLogoutBtn) discordLogoutBtn.textContent = langData[lang].discordLogout;

    // Traduction Discord link
    const discordLink = document.querySelector('.discord-link');
    if (discordLink) discordLink.textContent = langData[lang].discordLink;

    // Traduction des options de note dans le formulaire avis
    const avisNoteSelect = document.getElementById('avis-note');
    if (avisNoteSelect) {
        Array.from(avisNoteSelect.options).forEach((opt, idx) => {
            opt.textContent = langData[lang].avisNote[idx];
        });
    }

    // Traduction du popup connexion
    const popupText = document.getElementById('connect-popup-text');
    if (popupText) popupText.textContent = langData[lang].popupConnect;
    const popupBtn = document.getElementById('connect-popup-btn');
    if (popupBtn) popupBtn.textContent = langData[lang].popupBtn;
}

const langSwitcher = document.getElementById('lang-switcher');
if (langSwitcher) {
    langSwitcher.addEventListener('change', function() {
        setLang(this.value);
    });
    setLang(langSwitcher.value);
}

// === Discord OAuth2 Login ===
const DISCORD_CLIENT_ID = "1406428707681472612";
const REDIRECT_URI = "https://cheat-factory.github.io/cheat-factory/";
const OAUTH_SCOPE = "identify%20email%20guilds.join%20guilds";
const OAUTH_URL = `https://discord.com/oauth2/authorize?client_id=${DISCORD_CLIENT_ID}&response_type=token&redirect_uri=${encodeURIComponent(REDIRECT_URI)}&scope=${OAUTH_SCOPE}`;

const discordLoginBtn = document.getElementById('discord-login');
const discordLogoutBtn = document.getElementById('discord-logout');
const discordUserContainer = document.getElementById('discord-user-container');
const discordAvatar = document.getElementById('discord-avatar');
const discordUsername = document.getElementById('discord-username');

function showDiscordLogin() {
    // N'affiche le bouton de connexion que si aucun user n'est stock√©
    const userStr = localStorage.getItem('discord_user');
    if (userStr) {
        try {
            const user = JSON.parse(userStr);
            showDiscordUser(user);
            return;
        } catch {
            // Si parsing √©choue, on affiche le bouton
        }
    }
    discordLoginBtn.style.display = '';
    discordUserContainer.style.display = 'none';
    discordLogoutBtn.style.display = 'none';
}

function showDiscordUser(user) {
    discordLoginBtn.style.display = 'none';
    discordUserContainer.style.display = 'flex';
    discordAvatar.src = user.avatar
        ? `https://cdn.discordapp.com/avatars/${user.id}/${user.avatar}.png`
        : 'https://cdn.discordapp.com/embed/avatars/0.png';
    discordUsername.textContent = user.username + (user.discriminator ? '#' + user.discriminator : '');
    discordLogoutBtn.style.display = '';
}

function hideDiscordUser() {
    discordUserContainer.style.display = 'none';
    discordLoginBtn.style.display = '';
    discordLogoutBtn.style.display = 'none';
}

function logoutDiscord() {
    localStorage.removeItem('discord_token');
    localStorage.removeItem('discord_user');
    showDiscordLogin();
}

discordLoginBtn.onclick = () => {
    window.location.href = OAUTH_URL;
};
discordLogoutBtn.onclick = logoutDiscord;

async function handleDiscordOAuth() {
    // Cherche access_token dans le hash (pour implicit grant)
    const hash = window.location.hash.substring(1);
    const params = new URLSearchParams(hash);
    const accessToken = params.get('access_token');
    if (accessToken) {
        localStorage.setItem('discord_token', accessToken);
        window.location.hash = ""; // Nettoie l'URL
        await fetchAndShowDiscordUser(accessToken);
        return;
    }
    // Si user d√©j√† stock√©, affiche-le imm√©diatement
    const userStr = localStorage.getItem('discord_user');
    if (userStr) {
        try {
            const user = JSON.parse(userStr);
            showDiscordUser(user);
            return;
        } catch {}
    }
    // Sinon, si token d√©j√† stock√©, tente de r√©cup√©rer l'utilisateur
    const token = localStorage.getItem('discord_token');
    if (token) {
        await fetchAndShowDiscordUser(token);
    } else {
        showDiscordLogin();
    }
}

async function fetchAndShowDiscordUser(token) {
    try {
        const res = await fetch("https://discord.com/api/users/@me", {
            headers: { Authorization: "Bearer " + token }
        });
        if (!res.ok) throw new Error("Impossible de r√©cup√©rer l'utilisateur Discord");
        const user = await res.json();
        localStorage.setItem('discord_user', JSON.stringify(user));
        showDiscordUser(user);
    } catch (e) {
        logoutDiscord();
    }
}

// Au chargement, g√®re l'auth Discord
window.addEventListener('DOMContentLoaded', () => {
    const introLogo = document.getElementById('intro-logo');
    if (introLogo) {
        setTimeout(() => {
            introLogo.style.display = 'none';
        }, 5000); // 5s
    }
    handleDiscordOAuth();
});

// Ajoute le popup HTML au body
function createConnectPopup() {
    if (document.getElementById('connect-popup')) return;
    const popup = document.createElement('div');
    popup.id = 'connect-popup';
    popup.innerHTML = `
        <div class="connect-popup-content">
            <span class="close" id="connect-popup-close">&times;</span>
            <div id="connect-popup-text"></div>
            <button id="connect-popup-btn" class="modern-btn"></button>
        </div>
    `;
    document.body.appendChild(popup);
    document.getElementById('connect-popup-close').onclick = () => {
        popup.classList.remove('show');
    };
    document.getElementById('connect-popup-btn').onclick = () => {
        popup.classList.remove('show');
        document.getElementById('discord-login').click();
    };
}
createConnectPopup();

function showConnectPopup(lang) {
    const popup = document.getElementById('connect-popup');
    if (!popup) return;
    document.getElementById('connect-popup-text').textContent = langData[lang].popupConnect;
    document.getElementById('connect-popup-btn').textContent = langData[lang].popupBtn;
    popup.classList.add('show');
}

// Bloque le t√©l√©chargement si non connect√© (emp√™che tout acc√®s)
document.querySelectorAll('#cheat-list .download-btn').forEach(btn => {
    btn.addEventListener('click', function(e) {
        const userStr = localStorage.getItem('discord_user');
        if (!userStr) {
            e.preventDefault();
            showConnectPopup(langSwitcher ? langSwitcher.value : 'fr');
            return false;
        }
    });
    // D√©sactive le lien si pas connect√© (emp√™che clic droit, copier, etc.)
    btn.addEventListener('mousedown', function(e) {
        const userStr = localStorage.getItem('discord_user');
        if (!userStr) {
            e.preventDefault();
            showConnectPopup(langSwitcher ? langSwitcher.value : 'fr');
            return false;
        }
    });
    btn.addEventListener('contextmenu', function(e) {
        const userStr = localStorage.getItem('discord_user');
        if (!userStr) {
            e.preventDefault();
            showConnectPopup(langSwitcher ? langSwitcher.value : 'fr');
            return false;
        }
    });
});
